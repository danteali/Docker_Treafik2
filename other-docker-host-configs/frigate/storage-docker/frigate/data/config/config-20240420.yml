# yaml-language-server: $schema=http://192.168.0.20:5005/api/config/schema.json
# Above line enables automatic validation of config file by Frigate server

#RLC-510WA URLs
#RTSP
#rtsp://admin:ao6spFQWeN@192.168.0.201:554/h264Preview_01_main
#rtsp://admin:ao6spFQWeN@192.168.0.201:554/h264Preview_01_sub
#RTMP
#rtmp://192.168.0.201:1935/bcs/channel0_main.bcs?channel=0&stream=0&user=admin&password=ao6spFQWeN
#rtmp://192.168.0.201:1935/bcs/channel0_sub.bcs?channel=0&stream=0&user=admin&password=ao6spFQWeN
#rtmp://192.168.0.201:1935/bcs/channel0_ext.bcs?channel=0&stream=0&user=admin&password=ao6spFQWeN
#rtmp://192.168.0.201:1935/bcs/channel0_mobile.bcs?channel=0&stream=0&user=admin&password=ao6spFQWeN
#http://192.168.0.201/flv?port=1935&app=bcs&stream=channel0_main.bcs&user=admin&password=ao6spFQWeN
#http://192.168.0.201/flv?port=1935&app=bcs&stream=channel0_sub.bcs&user=admin&password=ao6spFQWeN
#http://192.168.0.201/flv?port=1935&app=bcs&stream=channel0_ext.bcs&user=admin&password=ao6spFQWeN
#http://192.168.0.201/flv?port=1935&app=bcs&stream=channel0_mobile.bcs&user=admin&password=ao6spFQWeN
#HTTP - JPEG Snapshot
#http://192.168.0.201/cgi-bin/api.cgi?cmd=Snap&channel=0&rs=123&user=admin&password=ao6spFQWeN
# ONVIF
#onvif://admin:ao6spFQWeN@192.168.0.201:8000

# Reolink camera settings from: https://docs.frigate.video/configuration/camera_specific#reolink-cameras


# CUSTOM NOTE: Required for Home Assistant Integration
mqtt:
  # Optional: Enable mqtt server (default: True)
  enabled: True
  # Required: host name
  host: 192.168.0.10
  # Optional: port (default: 1883)
  port: 1883
  # Optional: topic prefix (default: frigate)
  # NOTE: must be unique if you are running multiple instances
  topic_prefix: frigate
  # Optional: client id (default: frigate)
  # NOTE: must be unique if you are running multiple instances
  client_id: frigate
  # Optional: user
  # NOTE: MQTT user can be specified with an environment variables that must begin with 'FRIGATE_'.
  #       e.g. user: '{FRIGATE_MQTT_USER}'
  #user: mqtt_user
  # Optional: password
  # NOTE: MQTT password can be specified with an environment variables that must begin with 'FRIGATE_'.
  #       e.g. password: '{FRIGATE_MQTT_PASSWORD}'
  #password: password
  # Optional: tls_ca_certs for enabling TLS using self-signed certs (default: None)
  #tls_ca_certs: /path/to/ca.crt
  # Optional: tls_client_cert and tls_client key in order to use self-signed client
  # certificates (default: None)
  # NOTE: certificate must not be password-protected
  #       do not set user and password when using a client certificate
  #tls_client_cert: /path/to/client.crt
  #tls_client_key: /path/to/client.key
  # Optional: tls_insecure (true/false) for enabling TLS verification of
  # the server hostname in the server certificate (default: None)
  #tls_insecure: false
  # Optional: interval in seconds for publishing stats (default: 60)
  stats_interval: 60

# ==================================================================================

# Optional: Restream configuration (https://docs.frigate.video/configuration/restream)
# Uses https://github.com/AlexxIT/go2rtc (v1.2.0)
# WEB INTERFACE IS ON PORT 1984 SINCE 0.13
go2rtc:
  
  streams:
    SouthSide_main: 
      - "rtsp://admin:ao6spFQWeN@192.168.30.160:554/h265Preview_01_main"
      #- "ffmpeg:rtsp://admin:ao6spFQWeN@192.168.30.160:554/h265Preview_01_main#video=h264#audio=opus"
      #- rtmp://192.168.30.160:1935/bcs/channel0_main.bcs?channel=0&stream=0&user=admin&password=ao6spFQWeN
      #- http://192.168.30.160/flv?port=1935&app=bcs&stream=channel0_main.bcs&user=admin&password=ao6spFQWeN
      #- "ffmpeg:SouthSide_main#video=h264#audio=opus" # <- copy of the stream which transcodes audio to opus (name needs to match cam name). don't think it ever worked properly since there is no H264 stream
      #- "ffmpeg:SouthSide_main#video=copy#audio=opus" # <- copy of the stream which transcodes audio to opus (name needs to match cam name)
    SouthSide_sub: 
      - rtsp://admin:ao6spFQWeN@192.168.30.160:554/h264Preview_01_sub
      #- rtmp://192.168.30.160:1935/bcs/channel0_sub.bcs?channel=0&stream=0&user=admin&password=ao6spFQWeN
      #- http://192.168.30.160/flv?port=1935&app=bcs&stream=channel0_sub.bcs&user=admin&password=ao6spFQWeN
      - "ffmpeg:SouthSide_sub#audio=opus"
    FrontGarden_main: 
      # RTSP stream resulted in corrupt recordings continually being discarded so we used below http stream
      #- "http://192.168.30.161/flv?port=1935&app=bcs&stream=channel0_main.bcs&user=admin&password=ao6spFQWeN"
      - rtsp://admin:ao6spFQWeN@192.168.30.161:554/h264Preview_01_main
      - "ffmpeg:FrontGarden_main#audio=opus"
      #- "ffmpeg:FrontGarden_main#video=copy#audio=copy#audio=opus"
      #- "ffmpeg:FrontGarden_main#video=h264#audio=copy#audio=opus"
    FrontGarden_sub: 
      - rtsp://admin:ao6spFQWeN@192.168.30.161:554/h264Preview_01_sub
      #- "http://192.168.30.161/flv?port=1935&app=bcs&stream=channel0_sub.bcs&user=admin&password=ao6spFQWeN"
      - "ffmpeg:FrontGarden_sub#audio=opus"
    BackGarden_main: 
      - rtsp://admin:ao6spFQWeN@192.168.30.162:554/h264Preview_01_main
      - "ffmpeg:BackGarden_main#audio=opus"
    BackGarden_sub: 
      - rtsp://admin:ao6spFQWeN@192.168.30.162:554/h264Preview_01_sub
      - "ffmpeg:BackGarden_sub#audio=opus"
      
    # Ring Doorbell via ring-mqtt
    #Doorbell_live:
    #  - rtsp://ring-mqtt:8554/0cb2b71e76c1_live
    #  - "ffmpeg:Doorbell_live#audio=opus"
    #Doorbell_events:
    #  - rtsp://ring-mqtt:8554/0cb2b71e76c1_event
    #  - "ffmpeg:Doorbell_events#audio=opus"
  # CUSTOM NOTE: Should enable 'webrtc' stream in live view. 
  # See: https://docs.frigate.video/configuration/live/#webrtc-extra-configuration
  webrtc:
    candidates:
      - frigate.mc-guinness.co.uk:8555
      - stun:8555
      - 192.168.0.221:8555

  # HASS config only works if go2rtc is on the same host as Home Assistant.
  #hass:
  #  config: "/hass/config"
  #streams:
  #- hass:aqara_doorbell     # HASS source uses entity name (without 'camera.')
  #    - ffmpeg:aqara_doorbell#audio=aac#audio=opus


# ==================================================================================


# Required
cameras:
  # Required: name of the camera
  SouthSide:
    # Optional: Enable/Disable the camera (default: True).
    # If disabled: config is used but no live stream and no capture etc.
    # Events/Recordings are still viewable.
    enabled: True
    # Required: ffmpeg settings for the camera
    ffmpeg:
      # Required: A list of input streams for the camera. See documentation for more information.
      inputs:
        # Required: the path to the stream
        # NOTE: path may include environment variables, which must begin with 'FRIGATE_' and be referenced in {}
        # CUSTOM NOTE: Get stream URLs from go2rtc 'links' page
        #  -> Go to the go2rtc page (https://frigate.mc-guinness.co.uk/live/webrtc/) and click 'links' beside the stream.
        # These initial pths were those we have previously tried when trying to get recording to work properly with this camera.
        #- path: rtsp://127.0.0.1:8554/SouthSide_main?video=copy&audio=aac
        #- path: rtsp://127.0.0.1:8554/SouthSide_main?mp4
        #- path: rtsp://admin:ao6spFQWeN@192.168.30.160:554/h264Preview_01_main  # Doesn't work since no H264 stream
        # Used below path on NAS and seemed to work for recording in H265 but playback never worked properly.
        #- path: rtsp://127.0.0.1:8554/SouthSide_main?video=h264&audio=aac
        # Amended above path to use video=copy to get working H265 video stream for new 'record' output args to convert to H264.
        - path: rtsp://127.0.0.1:8554/SouthSide_main?video=copy&audio=aac
        # Confirmed below direct camera path working for recording once we enable 'record' output args for this camera to convert to H264
        # We can use this if the go2rtc stream does work.
        #- path: rtsp://admin:ao6spFQWeN@192.168.30.160:554/h265Preview_01_main
          # Required: list of roles for this stream. valid values are: detect,record,rtmp
          # NOTICE: In addition to assigning the record and rtmp roles,
          # they must also be enabled in the camera config.
          roles:
            - record
          # Optional: stream specific global args (default: inherit)
          #global_args:
          # Optional: stream specific hwaccel args (default: inherit = preset-vaapi)
          #hwaccel_args: preset-intel-qsv-h265
          # Optional: stream specific input args (default: inherit = preset-rtsp-restream)
          # From: https://docs.frigate.video/configuration/ffmpeg_presets
          #input_args: preset-rtsp-restream
        - path: rtsp://127.0.0.1:8554/SouthSide_sub?video=copy  # Note - no audio needed in detect stream
          roles:
            - detect
            #- record
          #input_args: preset-rtsp-restream
      # Optional: camera specific global args (default: inherit)
      #global_args:
      # Optional: camera specific hwaccel args (default: inherit)
      #hwaccel_args:
      # Optional: camera specific input args (default: inherit)
      #input_args:
      # Optional: camera specific output args (default: inherit)
      output_args:
        # Our objective is to get ffmpeg to convert the Duo 2's H265 stream to H264 for proper playback of events.
        # until Sept 23 we just lived with not having proper playback and couldreview recordings manually but
        # once we moved to LXC container we wanted to get Frigate working properly.
        # See H265 info at: https://docs.frigate.video/configuration/camera_specific/#annke-c800
        #record: -f segment -segment_time 10 -segment_format mp4 -reset_timestamps 1 -strftime 1 -c:v copy -tag:v hvc1 -bsf:v hevc_mp4toannexb -c:a aac
        # See: https://github.com/blakeblackshear/frigate/issues/2444#issuecomment-993659512
        #record: -map 0:v -f segment -segment_time 10 -segment_format mp4 -reset_timestamps 1 -strftime 1 -c:v h264_nvenc -b:v 4M -r 15
        #   -c:v h264_nvenc = use nvidia nvenc - we need to switch to vaapi intel igpu encoding (h264_vaapi)
        #   h264_vaapi supports max 4096x4096, not the camera's 4608x1728. Auto-scale to 4096 wide but keep aspect ratio. '-2' keeps height divisible by 2)
        #record: -f segment -segment_time 10 -segment_format mp4 -reset_timestamps 1 -strftime 1 -codec:v h264_vaapi -b:v 4M -r 15 -vf "scale_vaapi=4096:-2"
        # Just expanded parameters to make more readable
        record:
          -f segment
          -segment_time 10
          -segment_format mp4
          -reset_timestamps 1
          -strftime 1
          -codec:v h264_vaapi
          -b:v 4M
          -r 15
          -vf "scale_vaapi=4096:-2"
        # Also tried removing all args not related to codec/format - want Frigate to handle segmentation etc. Above seems to work fine but don't want to 
        # hardcode in case Frigate handling changes. DIDN'T WORK!
    # Optional: timeout for highest scoring image before allowing it
    # to be replaced by a newer image. (default: 60)
    best_image_timeout: 60

    # CUSTOM NOTE: Added this live section from 'Live' section of docs.
    # Optional: Set stream to be used for live WebGUI view.
    #live:
    #  stream_name: SouthSide_sub

    # Defaults to recording stream.
    # Optional: zones for this camera
    zones:
      # Required: name of the zone
      # NOTE: This must be different than any camera names, but can match with another zone on another
      #       camera.
      street-parking-bay:
        # Required: List of x,y coordinates to define the polygon of the zone.
        # NOTE: Presence in a zone is evaluated only based on the bottom center of the objects bounding box.
        # Can be created in the GUI
        coordinates: 147,366,474,520,511,468,629,481,808,362,195,314
        # Optional: List of objects that can trigger this zone (default: all tracked objects)
        # Trying to exclude cars from being tracked in this zone to avoid stationary car recording
        # Didn't work fully - parked cars still being recorded. 
        #objects:      
        #  - person
        #  - bicycle
        #  - motorcycle
        #  - dog
        #  - cat
        # Optional: Zone level object filters.
        # NOTE: The global and camera filters are applied upstream.
        #filters:
        #  person:
        #    min_area: 5000
        #    max_area: 100000
        #    threshold: 0.7
      street-street:
        coordinates: 808,362,195,314,186,320,37,309,105,266,394,232,694,138,871,131,1005,190,1242,228,1364,315,806,367
      street-driveway:
        coordinates: 1488,422,1514,386,1364,315,1287,320
      street-johnjen-garden:
        coordinates: 871,131,1005,190,1242,228,1280,229,1138,148,1031,147,903,97,853,99
      street-johnjen-driveway:
        coordinates: 689,48,829,52,900,141,686,147
        # Trying to exclude cars from being tracked in this zone to avoid stationary car recording
        # Didn't work fully - parked cars still being recorded. 
        #objects:      
        #  - person
        #  - bicycle
        #  - motorcycle
        #  - dog
        #  - cat
      street-parkpath:
        coordinates: 1536,258,1430,204,1152,68,1124,133,1280,233,1237,233,1290,260,1314,258,1500,378,1536,348
      street-gardens:
        coordinates: 236,255,528,202,526,123,364,164,287,196,199,222,160,239,130,267
        # Trying to exclude cars from being tracked in this zone to avoid stationary car recording
        # Didn't work fully - parked cars still being recorded. 
        #objects:      
        #  - person
        #  - bicycle
        #  - motorcycle
        #  - dog
        #  - cat

    # Optional: Configuration for the jpg snapshots published via MQTT
    # CUSTOM NOTE: Required for Home Assistant Integration
    mqtt:
      # Optional: Enable publishing snapshot via mqtt for camera (default: True)
      # NOTE: Only applies to publishing image data to MQTT via 'frigate/<camera_name>/<object_name>/snapshot'.
      # All other messages will still be published.
      enabled: True
      # Optional: print a timestamp on the snapshots (default: True)
      timestamp: True
      # Optional: draw bounding box on the snapshots (default: True)
      bounding_box: True
      # Optional: crop the snapshot (default: True)
      crop: True
      # Optional: height to resize the snapshot to (default: 270)
      height: 270
      # Optional: jpeg encode quality (default: 70)
      quality: 70
      # Optional: Restrict mqtt messages to objects that entered any of the listed zones (default: no required zones)
      #required_zones: []

    # Optional: Configuration for how camera is handled in the GUI.
    ui:
      # Optional: Adjust sort order of cameras in the UI. Larger numbers come later (default: 0)
      # By default the cameras are sorted alphabetically.
      order: 0
      # Optional: Whether or not to show the camera in the Frigate UI (default: True)
      dashboard: True

    # Optional: Camera-specific Detect configuration
    # NOTE: Overrides global settings for this camera
    detect:
      # Optional: width of the frame for the input with the detect role (default: 1280)
      width: 1536
      # Optional: height of the frame for the input with the detect role (default: 720)
      height: 576
      # Optional: desired fps for your camera for the input with the detect role (default: 5)
      # NOTE: Recommended value of 5. Ideally, try and reduce your FPS on the camera.
      # Have set on camera - don't want to set here also in case some kind of conflict.
      #fps: 4
      # Optional: Configuration for stationary object tracking
      #stationary:
        # Check latest config file - this section has changed
        # Optional: Frequency for confirming stationary objects (default: 50)
        # When set to 0, object detection will not confirm stationary objects until movement is detected.
        # If set to 10, object detection will run to confirm the object still exists on every 10th frame.
        #interval: 50
        # Optional: Number of frames without a position change for an object to be considered stationary (default: 50)
        #threshold: 50
        # Optional: Define a maximum number of frames for tracking a stationary object (default: not set, track forever)
        # This can help with false positives for objects that should only be stationary for a limited amount of time.
        # It can also be used to disable stationary object tracking. For example, you may want to set a value for person, but leave
        # car at the default.
        # WARNING: Setting these values overrides default behavior and disables stationary object tracking.
        #          There are very few situations where you would want it disabled. It is NOT recommended to
        #          copy these values from the example config into your config unless you know they are needed.
        #max_frames:
          # Optional: Default for all object types (default: not set, track forever)
          #default: 2700 # 900 frames per minute
          # Optional: Object specific values
          #objects:
          #  person: 1000
      # Optional: Milliseconds to offset detect annotations by (default: 0).
      # There can often be latency between a recording and the detect process,
      # especially when using separate streams for detect and record.
      # Use this setting to make the timeline bounding boxes more closely align
      # with the recording. The value can be positive or negative.
      # TIP: Imagine there is an event clip with a person walking from left to right.
      #      If the event timeline bounding box is consistently to the left of the person
      #      then the value should be decreased. Similarly, if a person is walking from
      #      left to right and the bounding box is consistently ahead of the person
      #      then the value should be increased.
      # TIP: This offset is dynamic so you can change the value and it will update existing
      #      events, this makes it easy to tune.
      # WARNING: Fast moving objects will likely not have the bounding box align.
      #annotation_offset: 0

    # Optional: Motion configuration (e.g. mask off camera embedded timestamp)
    # NOTE: Overrides global settings for this camera
    motion:
      # Optional: The threshold passed to cv2.threshold to determine if a pixel is different enough to be counted as motion. (default: 25)
      # Increasing this value will make motion detection less sensitive and decreasing it will make motion detection more sensitive.
      # The value should be between 1 and 255.
      #threshold: 25
      # Optional: Minimum size in pixels in the resized motion image that counts as motion (default: 30)
      # Increasing this value will prevent smaller areas of motion from being detected. Decreasing will
      # make motion detection more sensitive to smaller moving objects.
      # As a rule of thumb:
      #  - 15 - high sensitivity
      #  - 30 - medium sensitivity
      #  - 50 - low sensitivity
      #contour_area: 30
      # Optional: Alpha value passed to cv2.accumulateWeighted when averaging the motion delta across multiple frames (default: 0.2)
      # Higher values mean the current frame impacts the delta a lot, and a single raindrop may register as motion.
      # Too low and a fast moving person wont be detected as motion.
      #delta_alpha: 0.2
      # Optional: Alpha value passed to cv2.accumulateWeighted when averaging frames to determine the background (default: 0.2)
      # Higher values mean the current frame impacts the average a lot, and a new object will be averaged into the background faster.
      # Low values will cause things like moving shadows to be detected as motion for longer.
      # https://www.geeksforgeeks.org/background-subtraction-in-an-image-using-concept-of-running-average/
      #frame_alpha: 0.2
      # Optional: Height of the resized motion frame  (default: 50)
      # This operates as an efficient blur alternative. Higher values will result in more granular motion detection at the expense
      # of higher CPU usage. Lower values result in less CPU, but small changes may not register as motion.
      #frame_height: 50
      # Optional: motion mask
      # NOTE: see docs for more detailed info on creating masks
      # Can be created in the GUI
      mask: 
      - 1536,0,1536,50,1140,50,1140,0                             # Timestamp
      - 0,0,0,50,330,50,330,0                                     # Camera Name
      - 0,576,655,576,674,487,504,458,470,520,61,331,0,353        # Left - Garden Wall & House Side
      - 1536,576,1536,329,1344,576                                # Right - House Side
      - 957,48,623,45,373,104,0,237,0,0,1536,0,1536,224,1202,70   # Sky
      # Optional: improve contrast (default: False)
      # Enables dynamic contrast improvement. This should help improve night detections at the cost of making motion detection more sensitive
      # for daytime.
      #improve_contrast: False
      # Optional: Delay when updating camera motion through MQTT from ON -> OFF (default: 30).
      mqtt_off_delay: 30

    # This section can be used to mask areas where specific objects shouldn't be detected.
    # This may be a good workaround when stationary object detection isn't working properly and 
    # we keep getting recordings of stationary cars.
    objects:
      filters:
        car:
          mask:
          - 147,366,474,520,511,468,629,481,808,362,195,314
          - 689,48,829,52,900,141,686,147
          - 236,255,528,202,526,123,364,164,287,196,199,222,160,239,130,267
          # street-parking-bay = 147,366,474,520,511,468,629,481,808,362,195,314
          # street-johnjen-driveway = 689,48,829,52,900,141,686,147
          # street-gardens = 236,255,528,202,526,123,364,164,287,196,199,222,160,239,130,267

# ----------------------------------------------------------------------------------

#  SouthSide-test-Main:
#    enabled: True
#    ffmpeg:
#      inputs:
#        #- path: rtsp://127.0.0.1:8554/SouthSide_main?video=copy&audio=aac
#        - path: rtsp://127.0.0.1:8554/SouthSide_main?video=h264&audio=aac
#        #- path: rtsp://127.0.0.1:8554/SouthSide_main?mp4
#        #- path: rtsp://admin:ao6spFQWeN@192.168.30.160:554/h264Preview_01_main
#          roles:
#            - record
#        - path: rtsp://127.0.0.1:8554/SouthSide_sub?video=copy  # Note - no audio needed in detect stream
#          roles:
#            - detect
#    best_image_timeout: 60
#
#    mqtt:
#      enabled: True
#      timestamp: True
#      bounding_box: True
#      crop: True
#      height: 270
#      quality: 70
#
#    ui:
#      #order: 0
#      dashboard: True
#
#    detect:
#      width: 1536
#      height: 576
#      fps: 4
#      
#    motion:
#      mask: 
#      - 1536,0,1536,50,1140,50,1140,0                             # Timestamp
#      - 0,0,0,50,330,50,330,0                                     # Camera Name
#      - 0,576,655,576,674,487,504,458,470,520,61,331,0,353        # Left - Garden Wall & House Side
#      - 1536,576,1536,329,1344,576                                # Right - House Side
#      - 957,48,623,45,373,104,0,237,0,0,1536,0,1536,224,1202,70   # Sky
#      mqtt_off_delay: 30

# ----------------------------------------------------------------------------------

#  Doorbell-live:
#    enabled: True
#    ffmpeg:
#      inputs:
#        - path: rtsp://ring-mqtt:8554/0cb2b71e76c1_live #?video=h264&audio=aac  # ring-mqtt stream
#        #- path: rtsp://127.0.0.1:8554/Doorbell_events?video=h264&audio=aac  # ring-mqtt stream
#          roles:
#            - detect
#            - record
#    best_image_timeout: 60
#
#    mqtt:
#      enabled: True
#      timestamp: True
#      bounding_box: True
#      crop: True
#      height: 270
#      quality: 70
#
#    ui:
#      #order: 0
#      dashboard: True
#
#    detect:
#      width: 1280
#      height: 720
#      fps: 15
#      
#    #motion:
#      #mask: 
#      #- 1536,0,1536,50,1140,50,1140,0                             # Timestamp
#      #mqtt_off_delay: 30

# ----------------------------------------------------------------------------------

#  Doorbell-events:
#    enabled: True
#    ffmpeg:
#      inputs:
#        #- path: rtsp://127.0.0.1:8554/Doorbell_live?video=h264&audio=aac  # ring-mqtt stream
#        - path: rtsp://ring-mqtt:8554/0cb2b71e76c1_events #?video=h264&audio=aac  # ring-mqtt stream
#          roles:
#            - detect
#            - record
#    best_image_timeout: 60
#
#    mqtt:
#      enabled: True
#      timestamp: True
#      bounding_box: True
#      crop: True
#      height: 270
#      quality: 70
#
#    ui:
#      #order: 0
#      dashboard: True
#
#    detect:
#      width: 1280
#      height: 720
#      fps: 15
#      
#    #motion:
#      #mask: 
#      #- 1536,0,1536,50,1140,50,1140,0                             # Timestamp
#      #mqtt_off_delay: 30

# ----------------------------------------------------------------------------------

  FrontGarden:
    enabled: True
    ffmpeg:
      inputs:
        - path: rtsp://127.0.0.1:8554/FrontGarden_main?video=copy&audio=all # audio=aac
          roles:
            - record
          #input_args: preset-rtsp-restream
        - path: rtsp://127.0.0.1:8554/FrontGarden_sub?video=copy
          roles:
            - detect
          #input_args: preset-rtsp-restream
    best_image_timeout: 60

    zones:
      front-house-parking:
        coordinates: 619,235,241,158,0,263,0,480,560,480
        # Trying to exclude cars from being tracked in this zone to avoid stationary car recording
        # Didn't work fully - parked cars still being recorded.
        #objects:      
        #  - person
        #  - bicycle
        #  - motorcycle
        #  - dog
        #  - cat
        #filters:
        #  person:
        #    min_area: 5000
        #    max_area: 100000
        #    threshold: 0.7
      front-driveway:
        coordinates: 41,147,241,102,640,162,640,255
      front-street:
        coordinates: 0,203,247,115,160,101,0,146
      front-park:
        coordinates: 189,95,640,165,640,102,438,74,281,67,120,63,58,74,61,101
      front-johnjen-garden:
        coordinates: 0,156,204,91,51,87,0,104

    mqtt:
      enabled: True
      timestamp: True
      bounding_box: True
      crop: True
      height: 270
      quality: 70
      #required_zones: []

    ui:
      #order: 0
      dashboard: True

    detect:
      width: 640
      height: 480
      #fps: 4
      
    # Optional: Motion configuration (e.g. mask off camera embedded timestamp)
    # NOTE: Overrides global settings for this camera
    motion:
      mask: 
        - 640,30,640,0,434,0,434,30                                 # Timestamp
        - 0,0,110,0,110,30,0,30                                     # Camera Name
      mqtt_off_delay: 30

    # This section can be used to mask areas where specific objects shouldn't be detected.
    # This may be a good workaround when stationary object detection isn't working properly and 
    # we keep getting recordings of stationary cars.
    objects:
      filters:
        car:
          mask:
          - 619,235,241,158,0,263,0,480,560,480
          # front-house-parking = 619,235,241,158,0,263,0,480,560,480

# ----------------------------------------------------------------------------------

  BackGarden:
    enabled: True
    ffmpeg:
      inputs:
        - path: rtsp://127.0.0.1:8554/BackGarden_main?video=copy&audio=all # audio=aac
          roles:
            - record
          #input_args: preset-rtsp-restream
        - path: rtsp://127.0.0.1:8554/BackGarden_sub?video=copy
          roles:
            - detect
          #input_args: preset-rtsp-restream
    best_image_timeout: 60

    #zones:
      #test_zone:
        #coordinates: 0,138,0,288,106,346,320,414,441,129,250,35
        #objects:
        #  - person
        #filters:
        #  person:
        #    min_area: 5000
        #    max_area: 100000
        #    threshold: 0.7

    mqtt:
      enabled: True
      timestamp: True
      bounding_box: True
      crop: True
      height: 270
      quality: 70
      #required_zones: []

    ui:
      #order: 0
      dashboard: True

    detect:
      width: 640
      height: 480
      #fps: 4
      
    # Optional: Motion configuration (e.g. mask off camera embedded timestamp)
    # NOTE: Overrides global settings for this camera
    motion:
      mask: 
        - 640,30,640,0,434,0,434,30                                 # Timestamp
        - 0,0,110,0,110,30,0,30                                     # Camera Name
      mqtt_off_delay: 30

# ==================================================================================

# Optional: Detectors configuration. Defaults to a single CPU detector
detectors:
  # Required: name of the detector
  #cpu:
    # Required: type of the detector
    # Frigate provided types include 'cpu', 'edgetpu', and 'openvino' (default: cpu)
    # Additional detector types can also be plugged in.
    # Detectors may require additional configuration.
    # Refer to the Detectors configuration page for more information.
    #type: cpu
  #Google Coral - see: https://docs.frigate.video/configuration/detectors
  coral:
    type: edgetpu
    device: pci:0    #pci:0 # PCIe or M.2 models
    #model:
    #  path: "/custom_model.tflite"

# ==================================================================================

# Optional: Database configuration
database:
  # The path to store the SQLite DB (default: /media/frigate/frigate.db)
  #path: /media/frigate/frigate.db
  # DB doesn't like being on enwtrok share so remapping to locally mounted volume.
  path: /frigate-db/frigate.db

# ==================================================================================

# Optional: logger verbosity settings
logger:
  # Optional: Default log verbosity (default: info)
  default: info
  # Optional: Component specific logger overrides (default: "frigate.event: debug")
  logs:
    frigate.event: error
    #ffmpeg: error

# ==================================================================================

# Optional: birdseye configuration
# NOTE: Can (enabled, mode) be overridden at the camera level
birdseye:
  # Optional: Enable birdseye view (default: True)
  enabled: False
  # Optional: Restream birdseye via RTSP (default: False)
  # NOTE: Enabling this will set birdseye to run 24/7 which may increase CPU usage somewhat.
  #restream: False
  # Optional: Width of the output resolution (default: 1280)
  #width: 1280
  # Optional: Height of the output resolution (default: 720)
  #height: 720
  # Optional: Encoding quality of the mpeg1 feed (default: 8)
  # 1 is the highest quality, and 31 is the lowest. Lower quality feeds utilize less CPU resources.
  #quality: 8
  # Optional: Mode of the view. Available options are: objects, motion, and continuous
  #   objects - cameras are included if they have had a tracked object within the last 30 seconds
  #   motion - cameras are included if motion was detected in the last 30 seconds
  #   continuous - all cameras are included always
  #mode: objects

# ==================================================================================

# Optional: ffmpeg configuration
# More information about presets at https://docs.frigate.video/configuration/ffmpeg_presets
ffmpeg:
  # Optional: global ffmpeg args (default: -hide_banner -loglevel warning -threads 2)
  global_args: -hide_banner -loglevel warning -threads 2
  # Optional: global hwaccel args (default: [])
  # NOTE: See hardware acceleration docs for your specific device
  # CUSTOM NOTE: This configures hw accel for ffmpeg DECODING (not detection or encoding)
  # CUSTOM NOTE: WSL - Couldn't find working hwaccel option for WSL. Commenting out section seemed to work fine.
  hwaccel_args: preset-vaapi            # Intell VAAPI
  #hwaccel_args: preset-intel-qsv-h264   # Intel Quicksync H.264 streams
  #hwaccel_args: preset-intel-qsv-h265   # Intel Quicksync H.265 streams
  # Optional: global input args (default: preset-rtsp-generic)
  input_args: preset-rtsp-restream
  # Optional: global output args
  output_args:
    # Optional: output args for detect streams (default: -threads 2 -f rawvideo -pix_fmt yuv420p)
    #detect: -threads 2 -f rawvideo -pix_fmt yuv420p
    # Optional: output args for record streams (default: preset-record-generic)
    record: preset-record-generic-audio-aac
    # Optional: output args for rtmp streams (default: preset-rtmp-generic)
    #rtmp: preset-rtmp-generic

# ==================================================================================

# Optional: Object configuration
# NOTE: Can be overridden at the camera level
objects:
  # Optional: list of objects to track from labelmap.txt (default: person)
  track:
    - person
    - car
    - bicycle
    - motorcycle
    - dog
    - cat
  # Optional: mask to prevent all object types from being detected in certain areas (default: no mask)
  # Checks based on the bottom center of the bounding box of the object.
  # NOTE: This mask is COMBINED with the object type specific mask below
  # Can be created in the GUI
  #mask: 0,0,1000,0,1000,200,0,200
  # Optional: filters to reduce false positives for specific object types
  #filters:
    #person:
      # Optional: minimum width*height of the bounding box for the detected object (default: 0)
      #min_area: 5000
      # Optional: maximum width*height of the bounding box for the detected object (default: 24000000)
      #max_area: 100000
      # Optional: minimum width/height of the bounding box for the detected object (default: 0)
      #min_ratio: 0.5
      # Optional: maximum width/height of the bounding box for the detected object (default: 24000000)
      #max_ratio: 2.0
      # Optional: minimum score for the object to initiate tracking (default: shown below)
      #min_score: 0.5
      # Optional: minimum decimal percentage for tracked object's computed score to be considered a true positive (default: shown below)
      #threshold: 0.7
      # Optional: mask to prevent this object type from being detected in certain areas (default: no mask)
      # Checks based on the bottom center of the bounding box of the object
      # Can be created in the GUI
      #mask: 0,0,1000,0,1000,200,0,200

# ==================================================================================

# Optional: Record configuration
# NOTE: Can be overridden at the camera level
record:
  # Optional: Enable recording (default: True)
  # WARNING: If recording is disabled in the config, turning it on via
  #          the UI or MQTT later will have no effect.
  enabled: True
  # Optional: Number of minutes to wait between cleanup runs (default: 60)
  # This can be used to reduce the frequency of deleting recording segments from disk if you want to minimize i/o
  #expire_interval: 60
  # Optional: Sync recordings with disk on startup and once a day (default: False).
  #sync_recordings: False
  # Optional: Retention settings for recording
  retain:
    # Optional: Number of days to retain recordings regardless of events (default: 10)
    # NOTE: This should be set to 0 and retention should be defined in events section below
    #       if you only want to retain recordings of events.
    #       Setting this value will enable 24x7 recording.
    # CUSTOM NOTE: Set to 0 to purge all recordings.
    days: 0
    # Optional: Mode for retention. Available options are: all, motion, and active_objects (default: all)
    #   all - save all recording segments regardless of activity
    #   motion - save all recordings segments with any detected motion
    #   active_objects - save all recording segments with active/moving objects
    # NOTE: this mode only applies when the days setting above is greater than 0
    #mode: all
  # Optional: Recording Export Settings
  export:
    # Optional: Timelapse Output Args (default: shown below).
    # NOTE: The default args are set to fit 24 hours of recording into 1 hour playback.
    # See https://stackoverflow.com/a/58268695 for more info on how these args work.
    # As an example: if you wanted to go from 24 hours to 30 minutes that would be going
    # from 86400 seconds to 1800 seconds which would be 1800 / 86400 = 0.02.
    # The -r (framerate) dictates how smooth the output video is.
    # So the args would be -vf setpts=0.02*PTS -r 30 in that case.
    #timelapse_args: "-vf setpts=0.04*PTS -r 30"
    # These args change the time-lapse speed to 60x (for fitting 1 hour of recording 
    # into 1 minute of time-lapse) with 25 FPS:
    timelapse_args: "-vf setpts=PTS/60 -r 25"
  # Optional: Event recording settings
  events:
    # Optional: Number of seconds before the event to include (default: 5)
    pre_capture: 20
    # Optional: Number of seconds after the event to include (default: 5)
    post_capture: 20
    # Optional: Objects to save recordings for. (default: all tracked objects)
    #objects:
    #  - person
    # Optional: Restrict recordings to objects that entered any of the listed zones (default: no required zones)
    #required_zones: []
    # Optional: Retention settings for recordings of events
    retain:
      # Required: Default retention days (default: 10)
      default: 7
      # Optional: Mode for retention. (default: motion)
      #   all - save all recording segments for events regardless of activity
      #   motion - save all recordings segments for events with any detected motion
      #   active_objects - save all recording segments for event with active/moving objects
      #
      # NOTE: If the retain mode for the camera is more restrictive than the mode configured
      #       here, the segments will already be gone by the time this mode is applied.
      #       For example, if the camera retain mode is "motion", the segments without motion are
      #       never stored, so setting the mode to "all" here won't bring them back.
      mode: active_objects
      # Optional: Per object retention days 
      objects:
        person: 15

# ==================================================================================

# Optional: Configuration for the jpg snapshots written to the clips directory for each event
# NOTE: Can be overridden at the camera level
snapshots:
  # Optional: Enable writing jpg snapshot to /media/frigate/clips (default: False)
  enabled: True
  # Optional: save a clean PNG copy of the snapshot image (default: True)
  clean_copy: True
  # Optional: print a timestamp on the snapshots (default: False)
  timestamp: True
  # Optional: draw bounding box on the snapshots (default: False)
  bounding_box: True
  # Optional: crop the snapshot (default: False)
  crop: False
  # Optional: height to resize the snapshot to (default: original size)
  #height: 175
  # Optional: Restrict snapshots to objects that entered any of the listed zones (default: no required zones)
  #required_zones: []
  # Optional: Camera override for retention settings (default: global values)
  retain:
    # Required: Default retention days (default: 10)
    default: 7
    # Optional: Per object retention days
    objects:
      person: 15

# ==================================================================================

## Optional: jsmpeg stream configuration for WebUI
#live:
  ## Optional: Set the name of the stream that should be used for live view
  ## in frigate WebUI. (default: name of camera)
  #stream_name: SouthSide
  ## Optional: Set the height of the jsmpeg stream. (default: 720)
  ## This must be less than or equal to the height of the detect stream. Lower resolutions
  ## reduce bandwidth required for viewing the jsmpeg stream. Width is computed to match known aspect ratio.
  #height: 576
  ## Optional: Set the encode quality of the jsmpeg stream (default: 8)
  ## 1 is the highest quality, and 31 is the lowest. Lower quality feeds utilize less CPU resources.
  #quality: 8

# ==================================================================================

# Optional: in-feed timestamp style configuration
# NOTE: Can be overridden at the camera level
timestamp_style:
  # Optional: Position of the timestamp (default: tl)
  #           "tl" (top left), "tr" (top right), "bl" (bottom left), "br" (bottom right)
  position: "bl"
  # Optional: Format specifier conform to the Python package "datetime" (default: "%m/%d/%Y %H:%M:%S")
  #           Additional Examples:
  #             german: "%d.%m.%Y %H:%M:%S"
  format: "%Y-%m-%d %H:%M:%S"
  # Optional: Color of font
  color:
    # All Required when color is specified (default: 255,255,255)
    red: 255
    green: 255
    blue: 255
  # Optional: Line thickness of font (default: 2)
  thickness: 1
  # Optional: Effect of lettering (default: None)
  #           None (No effect),
  #           "solid" (solid background in inverse color of font)
  #           "shadow" (shadow for font)
  #effect: None

# ==================================================================================

# Optional
ui:
  # Optional: Set the default live mode for cameras in the UI (default: mse)
  live_mode: mse #webrtc
  # Optional: Set a timezone to use in the UI (default: use browser local time)
  timezone: Europe/London
  # Optional: Use an experimental recordings / camera view UI (default: False)
  use_experimental: False
  # Optional: Set the time format used.
  # Options are browser, 12hour, or 24hour (default: browser)
  time_format: 24hour
  # Optional: Set the date style for a specified length.
  # Options are: full, long, medium, short
  # Examples:
  #    short: 2/11/23
  #    medium: Feb 11, 2023
  #    full: Saturday, February 11, 2023
  # (default: short).
  date_style: medium
  # Optional: Set the time style for a specified length.
  # Options are: full, long, medium, short
  # Examples:
  #    short: 8:14 PM
  #    medium: 8:15:22 PM
  #    full: 8:15:22 PM Mountain Standard Time
  # (default: medium).
  time_style: medium
  # Optional: Ability to manually override the date / time styling to use strftime format
  # https://www.gnu.org/software/libc/manual/html_node/Formatting-Calendar-Time.html
  # possible values are shown above (default: not set)
  strftime_fmt: "%Y-%m-%d %H:%M:%S"

# ==================================================================================

# Optional: Telemetry configuration
telemetry:
  # Optional: Enabled network interfaces for bandwidth stats monitoring (default: empty list, let nethogs search all)
  #network_interfaces:
  #  - eth
  #  - enp
  #  - eno
  #  - ens
  #  - wl
  #  - lo
  # Optional: Configure system stats
  stats:
    # Enable AMD GPU stats (default: True)
    #amd_gpu_stats: True
    # Enable Intel GPU stats (default: True)
    intel_gpu_stats: True
    # Enable network bandwidth stats monitoring for camera ffmpeg processes, go2rtc, and object detectors. (default: False)
    # NOTE: The container must either be privileged or have cap_net_admin, cap_net_raw capabilities enabled.
    network_bandwidth: True
  # Optional: Enable the latest version outbound check (default: True)
  # NOTE: If you use the HomeAssistant integration, disabling this will prevent it from reporting new versions
  version_check: True


# ==================================================================================

# Optional: set environment variables
#environment_vars:
#  EXAMPLE_VAR: value

## Using camera level config
## Optional: Detect configuration
## NOTE: Can be overridden at the camera level
#detect:
#  # Optional: width of the frame for the input with the detect role (default: 1280)
#  width: 1280
#  # Optional: height of the frame for the input with the detect role (default: 720)
#  height: 720
#  # Optional: desired fps for your camera for the input with the detect role (default: 5)
#  # NOTE: Recommended value of 5. Ideally, try and reduce your FPS on the camera.
#  fps: 5
#  # Optional: enables detection for the camera (default: True)
#  enabled: True
#  # Optional: Number of frames without a detection before Frigate considers an object to be gone. (default: 5x the frame rate)
#  max_disappeared: 25
#  # Optional: Configuration for stationary object tracking
#  stationary:
#    # Optional: Frequency for confirming stationary objects (default: 0)
#    # When set to 0, object detection will not confirm stationary objects until movement is detected.
#    # If set to 10, object detection will run to confirm the object still exists on every 10th frame.
#    interval: 0
#    # Optional: Number of frames without a position change for an object to be considered stationary (default: 10x the frame rate or 10s)
#    threshold: 50
#    # Optional: Define a maximum number of frames for tracking a stationary object (default: not set, track forever)
#    # This can help with false positives for objects that should only be stationary for a limited amount of time.
#    # It can also be used to disable stationary object tracking. For example, you may want to set a value for person, but leave
#    # car at the default.
#    # WARNING: Setting these values overrides default behavior and disables stationary object tracking.
#    #          There are very few situations where you would want it disabled. It is NOT recommended to
#    #          copy these values from the example config into your config unless you know they are needed.
#    max_frames:
#      # Optional: Default for all object types (default: not set, track forever)
#      default: 3000
#      # Optional: Object specific values
#      objects:
#        person: 1000

# Optional: Motion configuration
# NOTE: Can be overridden at the camera level
#motion:
  # Optional: The threshold passed to cv2.threshold to determine if a pixel is different enough to be counted as motion. (default: 25)
  # Increasing this value will make motion detection less sensitive and decreasing it will make motion detection more sensitive.
  # The value should be between 1 and 255.
  #threshold: 25
  # Optional: Minimum size in pixels in the resized motion image that counts as motion (default: 30)
  # Increasing this value will prevent smaller areas of motion from being detected. Decreasing will
  # make motion detection more sensitive to smaller moving objects.
  # As a rule of thumb:
  #  - 15 - high sensitivity
  #  - 30 - medium sensitivity
  #  - 50 - low sensitivity
  #contour_area: 30
  # Optional: Alpha value passed to cv2.accumulateWeighted when averaging the motion delta across multiple frames (default: 0.2)
  # Higher values mean the current frame impacts the delta a lot, and a single raindrop may register as motion.
  # Too low and a fast moving person wont be detected as motion.
  #delta_alpha: 0.2
  # Optional: Alpha value passed to cv2.accumulateWeighted when averaging frames to determine the background (default: 0.2)
  # Higher values mean the current frame impacts the average a lot, and a new object will be averaged into the background faster.
  # Low values will cause things like moving shadows to be detected as motion for longer.
  # https://www.geeksforgeeks.org/background-subtraction-in-an-image-using-concept-of-running-average/
  #frame_alpha: 0.2
  # Optional: Height of the resized motion frame  (default: 50)
  # This operates as an efficient blur alternative. Higher values will result in more granular motion detection at the expense
  # of higher CPU usage. Lower values result in less CPU, but small changes may not register as motion.
  #frame_height: 50
  # Optional: motion mask
  # NOTE: see docs for more detailed info on creating masks
  # Can be created in the GUI
  #mask: 0,900,1080,900,1080,1920,0,1920
  # Optional: improve contrast (default: False)
  # Enables dynamic contrast improvement. This should help improve night detections at the cost of making motion detection more sensitive
  # for daytime.
  #improve_contrast: False
  # Optional: Delay when updating camera motion through MQTT from ON -> OFF (default: 30).
  #mqtt_off_delay: 30
  
# Optional: model modifications
#model:
#  # Optional: path to the model (default: automatic based on detector)
#  path: /edgetpu_model.tflite
#  # Optional: path to the labelmap (default: /labelmap.txt)
#  labelmap_path: /labelmap.txt
#  # Required: Object detection model input width (default: 320)
#  width: 320
#  # Required: Object detection model input height (default: 320)
#  height: 320
#  # Optional: Object detection model input colorspace
#  # Valid values are rgb, bgr, or yuv. (default: rgb)
#  input_pixel_format: rgb
#  # Optional: Object detection model input tensor format
#  # Valid values are nhwc or nchw (default: nhwc)
#  input_tensor: nhwc
#  # Optional: Object detection model type, currently only used with the OpenVINO detector
#  # Valid values are ssd, yolox, yolov5, or yolov8 (default: ssd)
#  model_type: ssd
#  # Optional: Label name modifications. These are merged into the standard labelmap.
#  labelmap:
#    2: vehicle

# Optional: RTMP configuration
# NOTE: RTMP is deprecated in favor of restream
# NOTE: Can be overridden at the camera level
#rtmp:
  # Optional: Enable the RTMP stream (default: False)
  #enabled: False
