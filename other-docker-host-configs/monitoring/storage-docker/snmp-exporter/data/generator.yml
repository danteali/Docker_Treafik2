# MULTIPLE SOURCES USED TO POPULATE FILE, INCLUDING:
# https://blog.cyberfront.org/index.php/2021/12/31/debian-prometheus-snmp/
# https://github.com/bryanalves/edgerouter_snmp_exporter
# https://github.com/j18e/prometheus-edgerouter

auths:
  public_v2:
    version: 2
    community: public

modules:

  # =================================================================================================
  # EDGE ROUTER
  # =================================================================================================
  edgerouter:
    timeout: 10s
    retries: 3
    walk:
      - hrSystemUptime
      - hrSystemNumUsers
      - hrSystemProcesses
      - hrStorage
      - interfaces      # This grabs all if* metrics
      #- ip              # All ip* entries - too many
      - ipTrafficStats
      - ipInReceives
      - ipInHdrErrors
      - ipInAddrErrors
      - ipInUnknownProtos
      - ipInDiscards
      - ipInDelivers
      - ipOutRequests
      - ipOutDiscards
      - ipOutNoRoutes
      - ipReasmReqds
      - ipReasmOKs
      - ipReasmFails
      - ipFragOKs
      - ipFragFails
      - ipFragCreates
      - icmp
      - ifXTable
      - 1.3.6.1.4.1.2021.4 # UCD memory
      - 1.3.6.1.4.1.2021.10 # UCD Load
      - systemStats
      - memTotalReal
      - memAvailReal
      - ssCpuRawIdle
      - hrSystemMaxProcesses
      - hrMemorySize
      - hrStorageSize
      - hrStorageUsed
      - hrProcessorLoad # non idle percent past minute
      - tcpMaxConn
      - tcpActiveOpens
      - tcpPassiveOpens
      - tcpEstabResets
      - tcpCurrEstab
      - diskIODevice
      - diskIONRead
      - diskIONWritten
      - diskIOReads
      - diskIOWrites
      - diskIOLA1
      - diskIOLA5
      - diskIOLA15
      - diskIONReadX
      - diskIONWrittenX

    lookups:
      - source_indexes: [ifIndex]
        lookup: ifAlias
        drop_source_indexes: true
      - source_indexes: [ipIfStatsIfIndex]
        lookup: ifAlias
        drop_source_indexes: true
      - source_indexes: [hrStorageIndex]
        lookup: hrStorageDescr
        drop_source_indexes: true
      - source_indexes: [laIndex]
        lookup: laNames
        drop_source_indexes: true
      - source_indexes: [bgpPeerRemoteAddr]
        lookup: bgpPeerRemoteAs
    overrides:
      bgpPeerState:
        type: EnumAsStateSet
      bgpPeerAdminStatus:
        type: EnumAsStateSet

  # =================================================================================================
  # Ubiquiti / UniFi
  # =================================================================================================
  #
  # http://dl.ubnt-ut.com/snmp/UBNT-MIB
  # http://dl.ubnt-ut.com/snmp/UBNT-UniFi-MIB
  #
  # =================================================================================================
  ubiquiti_unifi:
      timeout: 10s
      retries: 3
      walk:
        - sysUpTime
        - interfaces
        - ifXTable
      overrides:
        ifType:
          type: EnumAsInfo